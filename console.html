<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overlay Console</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* justify-content: center; */ /* Allow scrolling if content overflows */
            padding-top: 30px; /* Add some padding at the top */
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            padding: 20px;
            box-sizing: border-box;
        }
        .control-group {
            margin-bottom: 25px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            width: 300px;
            text-align: center;
        }
        .controls {
            display: flex;
            align-items: center;
            justify-content: space-around;
            gap: 15px;
            margin-top: 10px;
        }
        .toggleButton {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            color: white;
            min-width: 130px; /* Adjusted min-width for potentially longer names */
        }
        .statusIndicator {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid #555;
        }
        .status-shown { background-color: #4CAF50; }
        .status-hidden { background-color: #f44336; }
        .button-show { background-color: #4CAF50; }
        .button-hide { background-color: #f44336; }
        h1 { margin-bottom: 30px; color: #333; text-align: center;}
        h2 { margin-bottom: 5px; font-size: 1.2em; color: #444; }
        .instructions-link {
            display: block;
            text-align: center;
            margin: 20px 0;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <h1>Overlay Control Console</h1>
    <a href="overlayconfig.html" target="_blank" class="instructions-link">Open Overlay Configuration Page</a>


    <div class="control-group">
        <h2>Overlay 1 (Logo)</h2>
        <div class="controls">
            <button id="toggleButton1" class="toggleButton">Show Logo</button>
            <div id="statusIndicator1" class="statusIndicator"></div>
        </div>
    </div>

    <div class="control-group">
        <h2>Overlay 2 (Ticker)</h2>
        <div class="controls">
            <button id="toggleButton2" class="toggleButton">Show Ticker</button>
            <div id="statusIndicator2" class="statusIndicator"></div>
        </div>
    </div>

    <div class="control-group">
        <h2>Overlay 3 (Lower Third)</h2>
        <div class="controls">
            <button id="toggleButton3" class="toggleButton">Show Lower Third</button>
            <div id="statusIndicator3" class="statusIndicator"></div>
        </div>
    </div>

    <script>
        const overlays = [
            {
                id: 1,
                buttonEl: document.getElementById('toggleButton1'),
                indicatorEl: document.getElementById('statusIndicator1'),
                storageKey: 'overlay1Visibility',
                defaultTextShow: 'Show Logo',
                defaultTextHide: 'Hide Logo',
                isVisible: false
            },
            {
                id: 2,
                buttonEl: document.getElementById('toggleButton2'),
                indicatorEl: document.getElementById('statusIndicator2'),
                storageKey: 'overlay2Visibility',
                defaultTextShow: 'Show Ticker',
                defaultTextHide: 'Hide Ticker',
                isVisible: false
            },
            { // New Overlay 3 configuration
                id: 3,
                buttonEl: document.getElementById('toggleButton3'),
                indicatorEl: document.getElementById('statusIndicator3'),
                storageKey: 'overlay3Visibility',
                defaultTextShow: 'Show Lower Third',
                defaultTextHide: 'Hide Lower Third',
                isVisible: false
            }
        ];

        function updateUI(overlay) {
            if (overlay.isVisible) {
                overlay.buttonEl.textContent = overlay.defaultTextHide;
                overlay.buttonEl.classList.remove('button-show');
                overlay.buttonEl.classList.add('button-hide');
                overlay.indicatorEl.classList.remove('status-hidden');
                overlay.indicatorEl.classList.add('status-shown');
            } else {
                overlay.buttonEl.textContent = overlay.defaultTextShow;
                overlay.buttonEl.classList.remove('button-hide');
                overlay.buttonEl.classList.add('button-show');
                overlay.indicatorEl.classList.remove('status-shown');
                overlay.indicatorEl.classList.add('status-hidden');
            }
        }

        function setOverlayVisibilityInStorage(overlayKey, visible) {
            localStorage.setItem(overlayKey, visible ? 'show' : 'hide');
            localStorage.setItem(overlayKey + 'Timestamp', Date.now());
        }

        function initializeConsole() {
            overlays.forEach(overlay => {
                const persistedState = localStorage.getItem(overlay.storageKey);
                if (persistedState === 'show') {
                    overlay.isVisible = true;
                } else {
                    overlay.isVisible = false;
                    if (persistedState !== 'hide') {
                        setOverlayVisibilityInStorage(overlay.storageKey, false);
                    }
                }
                updateUI(overlay);

                overlay.buttonEl.addEventListener('click', () => {
                    overlay.isVisible = !overlay.isVisible;
                    updateUI(overlay);
                    setOverlayVisibilityInStorage(overlay.storageKey, overlay.isVisible);
                });
            });
        }

        window.addEventListener('storage', (event) => {
            overlays.forEach(overlay => {
                // Only update if the primary visibility key changes
                if (event.key === overlay.storageKey) {
                    // Check explicitly for 'show' vs 'hide', as event.newValue could be null if cleared
                    overlay.isVisible = (event.newValue === 'show');
                    updateUI(overlay);
                }
            });
        });

        initializeConsole();
    </script>
</body>
</html>
